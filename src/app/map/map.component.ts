import { Component, Input, OnInit } from '@angular/core';
declare var mapboxgl: any;
declare let $: any;
declare let map: any;

@Component({
  selector: 'app-map',
  templateUrl: './map.component.html',
  styleUrls: ['./map.component.scss']
})
export class MapComponent implements OnInit {

  constructor() {
  }

  ngOnInit(): void {
    //this.changeMapDetails();

    mapboxgl.accessToken = 'pk.eyJ1Ijoic3BpZGVyZGFiIiwiYSI6ImNrdTU4eTI4czI0dG4ycHBjaDhoMHkzbW8ifQ.H8sB9tbmS09MQtesveUW2Q';

    map = new mapboxgl.Map({
      container: 'map',
      //style: 'mapbox://styles/spiderdab/cl8wvjdk3000315liyn5a5n0g',
      style: 'mapbox://styles/spiderdab/cl9cn3wtn007114mtpl68mvwd',
      center: [10.0, 45],
      zoom: 2.5,
      interactive: true,
      attributionControl: false,
      antialias: true,
      renderWorldCopies: false,
      projection: 'globe' // display the map as a 3D globe
    });


    map.on('load', () => {
      map.getStyle().layers.forEach((layer:any) => {
        //console.log("Ids: " + layer.id);
        if (layer.id.endsWith('label')) {
          map.setLayoutProperty(layer.id, 'visibility', 'none');
        }
      });
    });




    /* const nav = new mapboxgl.NavigationControl({
      visualizePitch: true
    });
    map.addControl(nav, 'top-right'); */
    //nav._container.parentNode.className="mapboxgl-ctrl-group"

    //console.log(nav._container.className);
/*     map.on('load', () => {
      const coords = {
        "type": "geojson",
        "data": {
          "type": "Feature",
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  -153.005,
                  -52.7204
                ],
                [
                  -152.635,
                  -51.7012
                ],
                [
                  -152.276,
                  -50.6786
                ],
                [
                  -151.927,
                  -49.6552
                ],
                [
                  -151.588,
                  -48.6309
                ],
                [
                  -151.259,
                  -47.606
                ],
                [
                  -150.937,
                  -46.5804
                ],
                [
                  -150.624,
                  -45.5541
                ],
                [
                  -150.317,
                  -44.5271
                ],
                [
                  -150.018,
                  -43.4996
                ],
                [
                  -149.724,
                  -42.4715
                ],
                [
                  -149.437,
                  -41.4427
                ],
                [
                  -149.155,
                  -40.4134
                ],
                [
                  -148.877,
                  -39.3836
                ],
                [
                  -148.604,
                  -38.3533
                ],
                [
                  -148.336,
                  -37.3225
                ],
                [
                  -148.072,
                  -36.2913
                ],
                [
                  -147.811,
                  -35.2595
                ],
                [
                  -147.554,
                  -34.2272
                ],
                [
                  -147.3,
                  -33.1945
                ],
                [
                  -147.049,
                  -32.1614
                ],
                [
                  -146.801,
                  -31.128
                ],
                [
                  -146.556,
                  -30.0941
                ],
                [
                  -146.313,
                  -29.0599
                ],
                [
                  -146.072,
                  -28.0253
                ],
                [
                  -145.833,
                  -26.9902
                ],
                [
                  -145.596,
                  -25.9549
                ],
                [
                  -145.36,
                  -24.9193
                ],
                [
                  -145.127,
                  -23.8834
                ],
                [
                  -144.895,
                  -22.8473
                ],
                [
                  -144.664,
                  -21.8107
                ],
                [
                  -144.434,
                  -20.7737
                ],
                [
                  -144.205,
                  -19.7364
                ],
                [
                  -143.977,
                  -18.6994
                ],
                [
                  -143.75,
                  -17.6624
                ],
                [
                  -143.523,
                  -16.6248
                ],
                [
                  -143.298,
                  -15.5862
                ],
                [
                  -143.073,
                  -14.5474
                ],
                [
                  -142.848,
                  -13.5091
                ],
                [
                  -142.623,
                  -12.4711
                ],
                [
                  -142.398,
                  -11.4329
                ],
                [
                  -142.173,
                  -10.3942
                ],
                [
                  -141.949,
                  -9.35504
                ],
                [
                  -141.724,
                  -8.31602
                ],
                [
                  -141.5,
                  -7.27693
                ],
                [
                  -141.274,
                  -6.23778
                ],
                [
                  -141.049,
                  -5.19869
                ],
                [
                  -140.822,
                  -4.15953
                ],
                [
                  -140.595,
                  -3.12024
                ],
                [
                  -140.368,
                  -2.08096
                ],
                [
                  -140.139,
                  -1.04164
                ],
                [
                  -139.91,
                  -0.002423
                ],
                [
                  -139.68,
                  1.03668
                ],
                [
                  -139.448,
                  2.07571
                ],
                [
                  -139.216,
                  3.11468
                ],
                [
                  -138.982,
                  4.15365
                ],
                [
                  -138.746,
                  5.1925
                ],
                [
                  -138.509,
                  6.23108
                ],
                [
                  -138.27,
                  7.26955
                ],
                [
                  -138.03,
                  8.30794
                ],
                [
                  -137.787,
                  9.34611
                ],
                [
                  -137.543,
                  10.384
                ],
                [
                  -137.296,
                  11.4217
                ],
                [
                  -137.047,
                  12.4591
                ],
                [
                  -136.796,
                  13.4963
                ],
                [
                  -136.542,
                  14.5331
                ],
                [
                  -136.285,
                  15.5696
                ],
                [
                  -136.025,
                  16.6058
                ],
                [
                  -135.763,
                  17.6416
                ],
                [
                  -135.497,
                  18.6771
                ],
                [
                  -135.227,
                  19.7121
                ],
                [
                  -134.955,
                  20.7467
                ],
                [
                  -134.678,
                  21.7807
                ],
                [
                  -134.397,
                  22.8142
                ],
                [
                  -134.112,
                  23.8473
                ],
                [
                  -133.822,
                  24.8799
                ],
                [
                  -133.528,
                  25.9118
                ],
                [
                  -133.229,
                  26.9431
                ],
                [
                  -132.924,
                  27.9737
                ],
                [
                  -132.614,
                  29.0036
                ],
                [
                  -132.298,
                  30.0328
                ],
                [
                  -131.976,
                  31.0613
                ],
                [
                  -131.648,
                  32.089
                ],
                [
                  -131.312,
                  33.1157
                ],
                [
                  -130.969,
                  34.1414
                ],
                [
                  -130.618,
                  35.1663
                ],
                [
                  -130.259,
                  36.1906
                ],
                [
                  -129.892,
                  37.214
                ],
                [
                  -129.515,
                  38.2358
                ],
                [
                  -129.127,
                  39.2556
                ],
                [
                  -128.729,
                  40.2745
                ],
                [
                  -128.321,
                  41.293
                ],
                [
                  -127.901,
                  42.3101
                ],
                [
                  -127.468,
                  43.3252
                ],
                [
                  -127.021,
                  44.3388
                ],
                [
                  -126.56,
                  45.3507
                ],
                [
                  -126.084,
                  46.3609
                ],
                [
                  -125.591,
                  47.3692
                ],
                [
                  -125.08,
                  48.3754
                ],
                [
                  -124.55,
                  49.3794
                ],
                [
                  -124.008,
                  50.3829
                ],
                [
                  -123.439,
                  51.3833
                ],
                [
                  -122.84,
                  52.3793
                ],
                [
                  -122.218,
                  53.3727
                ],
                [
                  -121.57,
                  54.3638
                ],
                [
                  -120.891,
                  55.351
                ],
                [
                  -120.178,
                  56.3343
                ],
                [
                  -119.431,
                  57.3143
                ],
                [
                  -118.645,
                  58.2895
                ],
                [
                  -117.817,
                  59.2601
                ],
                [
                  -116.944,
                  60.2259
                ],
                [
                  -116.02,
                  61.1859
                ],
                [
                  -115.043,
                  62.1399
                ],
                [
                  -114.006,
                  63.0873
                ],
                [
                  -112.902,
                  64.0272
                ],
                [
                  -111.724,
                  64.9586
                ],
                [
                  -110.466,
                  65.8808
                ],
                [
                  -109.116,
                  66.7922
                ],
                [
                  -107.665,
                  67.6914
                ],
                [
                  -106.104,
                  68.578
                ],
                [
                  -104.422,
                  69.45
                ],
                [
                  -102.602,
                  70.3053
                ],
                [
                  -100.63,
                  71.1415
                ],
                [
                  -98.489,
                  71.9563
                ],
                [
                  -96.1585,
                  72.7461
                ],
                [
                  -93.6241,
                  73.5087
                ],
                [
                  -90.855,
                  74.2372
                ],
                [
                  -87.8439,
                  74.9314
                ],
                [
                  -84.5562,
                  75.5814
                ],
                [
                  -80.9801,
                  76.1828
                ],
                [
                  -77.1055,
                  76.7297
                ],
                [
                  -72.9292,
                  77.215
                ],
                [
                  -68.4603,
                  77.6336
                ],
                [
                  -63.7187,
                  77.9793
                ],
                [
                  -58.7319,
                  78.2385
                ],
                [
                  -53.5653,
                  78.4086
                ],
                [
                  -48.2925,
                  78.4859
                ],
                [
                  -42.9913,
                  78.4692
                ],
                [
                  -37.7453,
                  78.3581
                ],
                [
                  -32.6368,
                  78.1552
                ],
                [
                  -27.7324,
                  77.8653
                ],
                [
                  -23.0842,
                  77.4933
                ],
                [
                  -18.7162,
                  77.0506
                ],
                [
                  -14.6523,
                  76.5403
                ],
                [
                  -10.8876,
                  75.9725
                ],
                [
                  -7.41887,
                  75.3524
                ],
                [
                  -4.23174,
                  74.6864
                ],
                [
                  -1.30784,
                  73.9801
                ],
                [
                  5.1e-15,
                  73.6185248082366
                ],
                [
                  1.37385,
                  73.2387
                ],
                [
                  3.83431,
                  72.4664
                ],
                [
                  6.09398,
                  71.6672
                ],
                [
                  8.17242,
                  70.8446
                ],
                [
                  8.26198,
                  70.8071
                ],
                [
                  9.63492,
                  71.149
                ],
                [
                  10.9919,
                  71.4662
                ],
                [
                  12.3342,
                  71.7609
                ],
                [
                  13.4622,
                  71.997
                ],
                [
                  14.8122,
                  72.2608
                ],
                [
                  16.1958,
                  72.5142
                ],
                [
                  17.6152,
                  72.7572
                ],
                [
                  18.8743,
                  72.9608
                ],
                [
                  20.4166,
                  73.192
                ],
                [
                  22.0579,
                  73.4191
                ],
                [
                  23.8084,
                  73.641
                ],
                [
                  25.4226,
                  73.8232
                ],
                [
                  27.4999,
                  74.0403
                ],
                [
                  29.8182,
                  74.2531
                ],
                [
                  32.0378,
                  74.4307
                ],
                [
                  34.9983,
                  74.6262
                ],
                [
                  38.5075,
                  74.8021
                ],
                [
                  42.7257,
                  74.9379
                ],
                [
                  45.143,
                  74.9797
                ],
                [
                  44.9631,
                  76.0001
                ],
                [
                  44.7784,
                  77.0204
                ],
                [
                  44.5873,
                  78.0405
                ],
                [
                  44.3875,
                  79.0604
                ],
                [
                  44.1781,
                  80.0803
                ],
                [
                  43.9537,
                  81.1001
                ],
                [
                  43.7101,
                  82.1198
                ],
                [
                  43.4385,
                  83.1395
                ],
                [
                  43.1236,
                  84.159
                ],
                [
                  42.787008975868154,
                  85.05115
                ],
                [
                  5.5e-15,
                  85.05115
                ],
                [
                  -135.95332389875404,
                  85.05115
                ],
                [
                  -136.136,
                  84.6231
                ],
                [
                  -136.483,
                  83.6039
                ],
                [
                  -136.774,
                  82.5844
                ],
                [
                  -137.028,
                  81.5646
                ],
                [
                  -137.26,
                  80.5447
                ],
                [
                  -137.476,
                  79.5247
                ],
                [
                  -137.679,
                  78.5047
                ],
                [
                  -137.874,
                  77.4846
                ],
                [
                  -138.063,
                  76.4642
                ],
                [
                  -138.246,
                  75.4436
                ],
                [
                  -138.424,
                  74.423
                ],
                [
                  -138.598,
                  73.4023
                ],
                [
                  -138.77,
                  72.3814
                ],
                [
                  -138.94,
                  71.3603
                ],
                [
                  -139.108,
                  70.3391
                ],
                [
                  -139.27,
                  69.3175
                ],
                [
                  -139.427,
                  68.2957
                ],
                [
                  -139.583,
                  67.2737
                ],
                [
                  -139.743,
                  66.2516
                ],
                [
                  -139.901,
                  65.2292
                ],
                [
                  -140.065,
                  64.2068
                ],
                [
                  -140.241,
                  63.1845
                ],
                [
                  -140.399,
                  62.1614
                ],
                [
                  -140.502,
                  61.1361
                ],
                [
                  -140.726,
                  60.1153
                ],
                [
                  -140.899,
                  59.0922
                ],
                [
                  -141.06,
                  58.0685
                ],
                [
                  -141.221,
                  57.0445
                ],
                [
                  -141.383,
                  56.0203
                ],
                [
                  -141.545,
                  54.9959
                ],
                [
                  -141.707,
                  53.9711
                ],
                [
                  -141.868,
                  52.946
                ],
                [
                  -142.029,
                  51.9209
                ],
                [
                  -142.193,
                  50.8955
                ],
                [
                  -142.357,
                  49.8697
                ],
                [
                  -142.52,
                  48.8437
                ],
                [
                  -142.684,
                  47.8176
                ],
                [
                  -142.848,
                  46.7911
                ],
                [
                  -143.013,
                  45.7644
                ],
                [
                  -143.179,
                  44.7376
                ],
                [
                  -143.345,
                  43.7098
                ],
                [
                  -143.511,
                  42.6819
                ],
                [
                  -143.679,
                  41.655
                ],
                [
                  -143.85,
                  40.6284
                ],
                [
                  -144.019,
                  39.6003
                ],
                [
                  -144.187,
                  38.5709
                ],
                [
                  -144.357,
                  37.5418
                ],
                [
                  -144.529,
                  36.513
                ],
                [
                  -144.702,
                  35.4844
                ],
                [
                  -144.875,
                  34.4554
                ],
                [
                  -145.049,
                  33.4259
                ],
                [
                  -145.225,
                  32.3963
                ],
                [
                  -145.401,
                  31.3665
                ],
                [
                  -145.578,
                  30.3366
                ],
                [
                  -145.756,
                  29.3066
                ],
                [
                  -145.936,
                  28.2764
                ],
                [
                  -146.117,
                  27.2459
                ],
                [
                  -146.299,
                  26.2153
                ],
                [
                  -146.482,
                  25.1848
                ],
                [
                  -146.667,
                  24.1541
                ],
                [
                  -146.852,
                  23.1233
                ],
                [
                  -147.04,
                  22.0924
                ],
                [
                  -147.228,
                  21.0613
                ],
                [
                  -147.419,
                  20.0302
                ],
                [
                  -147.61,
                  18.9991
                ],
                [
                  -147.804,
                  17.9679
                ],
                [
                  -147.998,
                  16.9368
                ],
                [
                  -148.195,
                  15.9057
                ],
                [
                  -148.393,
                  14.8745
                ],
                [
                  -148.593,
                  13.8435
                ],
                [
                  -148.795,
                  12.8123
                ],
                [
                  -148.999,
                  11.7814
                ],
                [
                  -149.205,
                  10.7504
                ],
                [
                  -149.413,
                  9.71954
                ],
                [
                  -149.623,
                  8.68889
                ],
                [
                  -149.835,
                  7.6584
                ],
                [
                  -150.05,
                  6.62793
                ],
                [
                  -150.267,
                  5.59759
                ],
                [
                  -150.486,
                  4.56762
                ],
                [
                  -150.708,
                  3.53784
                ],
                [
                  -150.932,
                  2.50831
                ],
                [
                  -151.159,
                  1.47904
                ],
                [
                  -151.388,
                  0.44996
                ],
                [
                  -151.621,
                  -0.578815
                ],
                [
                  -151.857,
                  -1.60725
                ],
                [
                  -152.095,
                  -2.63516
                ],
                [
                  -152.337,
                  -3.66273
                ],
                [
                  -152.582,
                  -4.68995
                ],
                [
                  -152.83,
                  -5.71679
                ],
                [
                  -153.082,
                  -6.74314
                ],
                [
                  -153.338,
                  -7.7695
                ],
                [
                  -153.597,
                  -8.79477
                ],
                [
                  -153.861,
                  -9.81844
                ],
                [
                  -154.13,
                  -10.8414
                ],
                [
                  -154.401,
                  -11.8651
                ],
                [
                  -154.676,
                  -12.8893
                ],
                [
                  -154.956,
                  -13.9122
                ],
                [
                  -155.242,
                  -14.9332
                ],
                [
                  -155.533,
                  -15.9531
                ],
                [
                  -155.829,
                  -16.9727
                ],
                [
                  -156.13,
                  -17.992
                ],
                [
                  -156.437,
                  -19.0101
                ],
                [
                  -156.75,
                  -20.0271
                ],
                [
                  -157.069,
                  -21.0431
                ],
                [
                  -157.394,
                  -22.0581
                ],
                [
                  -157.726,
                  -23.0721
                ],
                [
                  -158.065,
                  -24.085
                ],
                [
                  -158.411,
                  -25.0966
                ],
                [
                  -158.765,
                  -26.1069
                ],
                [
                  -159.127,
                  -27.1159
                ],
                [
                  -159.497,
                  -28.1235
                ],
                [
                  -159.876,
                  -29.1297
                ],
                [
                  -160.264,
                  -30.1344
                ],
                [
                  -160.662,
                  -31.1374
                ],
                [
                  -161.07,
                  -32.1388
                ],
                [
                  -161.488,
                  -33.1384
                ],
                [
                  -161.918,
                  -34.1359
                ],
                [
                  -162.36,
                  -35.1316
                ],
                [
                  -162.814,
                  -36.1251
                ],
                [
                  -163.282,
                  -37.1165
                ],
                [
                  -163.763,
                  -38.1057
                ],
                [
                  -164.258,
                  -39.0923
                ],
                [
                  -164.769,
                  -40.0763
                ],
                [
                  -165.297,
                  -41.0575
                ],
                [
                  -165.841,
                  -42.0358
                ],
                [
                  -166.404,
                  -43.0112
                ],
                [
                  -166.986,
                  -43.9832
                ],
                [
                  -167.589,
                  -44.9518
                ],
                [
                  -168.214,
                  -45.9167
                ],
                [
                  -168.862,
                  -46.8777
                ],
                [
                  -169.534,
                  -47.8344
                ],
                [
                  -170.233,
                  -48.7867
                ],
                [
                  -170.263,
                  -48.8271
                ],
                [
                  -168.563,
                  -49.3604
                ],
                [
                  -167.11,
                  -49.788
                ],
                [
                  -165.844,
                  -50.1392
                ],
                [
                  -164.874,
                  -50.3965
                ],
                [
                  -163.84,
                  -50.6585
                ],
                [
                  -162.88,
                  -50.8879
                ],
                [
                  -161.988,
                  -51.0947
                ],
                [
                  -161.274,
                  -51.2618
                ],
                [
                  -160.457,
                  -51.4374
                ],
                [
                  -159.663,
                  -51.6011
                ],
                [
                  -158.891,
                  -51.7542
                ],
                [
                  -158.228,
                  -51.8794
                ],
                [
                  -157.458,
                  -52.0207
                ],
                [
                  -156.682,
                  -52.1573
                ],
                [
                  -156.016,
                  -52.2675
                ],
                [
                  -155.206,
                  -52.3984
                ],
                [
                  -154.357,
                  -52.5289
                ],
                [
                  -153.464,
                  -52.6564
                ],
                [
                  -153.005,
                  -52.7204
                ]
              ]
            ]
          },
          "properties": {
            "name": "S2_ABCDE_176998752525_12345",
            "CreationDate": "2022-10-02",
            "Sensor": "ABCDE",
            "Color": "#8A2BE2"
          }
        }
      }

      map.addSource('test', coords);
      map.addLayer({
        'id': 'test',
        'type': 'fill',
        'source': 'test', // reference the data source
        'layout': {},
        'paint': {
        'fill-color': '#0080ff', // blue color fill
        'fill-opacity': 0.5
        }
      });
      map.addLayer({
        'id': 'outline',
        'type': 'line',
        'source': 'test',
        'layout': {},
        'paint': {
        'line-color': '#000',
        'line-width': 3
        }
      });
    }) */
  }

  changeMapDetails() {
    $(document).ready(function() {
      $('#labelsCheckbox').click(function() {
          if ($('#labelsCheckbox').is(':checked')) {
            map.getStyle().layers.forEach((layer:any) => {
              //console.log("Ids: " + layer.id);
              if (layer.id.endsWith('label')) {
                map.setLayoutProperty(layer.id, 'visibility', 'visible');
              }
            });
          } else {
            map.getStyle().layers.forEach((layer:any) => {
              //console.log("Ids: " + layer.id);
              if (layer.id.endsWith('label')) {
                map.setLayoutProperty(layer.id, 'visibility', 'none');
              }
            });
          }
      })
    });
  }
}
